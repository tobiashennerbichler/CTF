import pwn

def send_cheese(cheese):
    p.recvuntil(b"What would you like to do?\n")
    p.sendline(b"e")
    p.recvuntil(b"What cheese would you like to encrypt?")
    p.sendline(cheese.encode("utf-8"))
    p.recvuntil(b"Here's your encrypted cheese:  ")
    return p.recvline()[:-1]

def add_to_dict(message, encrypted, map):
    for (c1, c2) in zip(message.upper(), encrypted.upper()):
        map[c2] = c1
    return map

def translate_secret(secret, map):
    s = ""
    for c in secret:
        t = map.get(c)
        if t is None:
            s += "[" + chr(c) + "]"
        else:
            s += t
    print(s)

p = pwn.remote("verbal-sleep.picoctf.net", 56466)
p.recvuntil(b"you'll be able to guess it:  ")
secret = p.recvline()[:-1]
print(secret)

map = {}
for cheese in ["Pecorino Romano", "Kefalotyri"]:
    encrypted = send_cheese(cheese)
    map = add_to_dict(cheese, encrypted, map)

translate_secret(secret, map)
p.interactive()
